<!DOCTYPE html>
<!--[if IE 8]> 				 <html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->

<head>
  <meta charset="utf-8">
  <title>Library patterns: Why frameworks are evil</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="This article continues my mini-series on functional library design. Previously, I discussed why your library should provide multiple levels of abstraction. Today, we look at composability and avoiding callbacks. These two often go together - frameworks are based on callbacks and are not composable, while good libraries avoid callbacks and compose well. ">
  <meta name="author" content="Tomas Petricek">

  <!-- Reference Foundation -->
  <link rel="stylesheet" href="http://tomasp.net/css/foundation.css">
  <script src="js/vendor/custom.modernizr.js"></script>

  <link rel="alternate" type="application/rss+xml" href="http://tomasp.net/rss.xml" title="RSS feed for Tomas Petricek's blog">
  <link rel="icon" type="image/png" href="http://tomasp.net/img/favicon.png" />
    
  <!-- Reference custom CSS and tooltips -->
  <link type="text/css" rel="stylesheet" href="http://tomasp.net/custom/style.css" />
  <script type="text/javascript" src="http://tomasp.net/custom/tooltips.js"></script>
  <link type="text/css" rel="stylesheet" href="http://tomasp.net/custom/tooltips.css" />
  <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  <meta name="twitter:card" content="summary">
  <meta name="twitter:creator" content="@tomaspetricek">
  <meta name="twitter:title" content="Library patterns: Why frameworks are evil">
  <meta name="twitter:description" content="This article continues my mini-series on functional library design. Previously, I discussed why your library should provide multiple levels of abstraction. Today, we look at composability and avoiding callbacks. These two often go together - frameworks are based on callbacks and are not composable, while good libraries avoid callbacks and compose well. ">
    <meta name="twitter:image" content="http://tomasp.net/blog/2015/library-frameworks/diagram.png">
</head>
<body>

   <header id="top-header">
    <div class="row">
      <div class="twelve columns">
        <h1><a href="http://tomasp.net/">Tomas Petricek's blog</a></h1>
        <p>Writing about practical F# coding and programming language research</p>
      </div>
    </div>
  </header>

  <header class="top-bar-header">
    <div class="contain-to-grid sticky">
    <nav class="top-bar">

    <ul class="title-area">
      <li class="name"><h1><a href="#"></a></h1></li>
      <li class="toggle-topbar menu-icon"><a href="#"><span>Menu</span></a></li>
    </ul>
    <section class="top-bar-section">
      <ul class="right">
        <li><a href="http://tomasp.net/blog/index.html">Blog</a></li>
        <li><a href="http://functional-programming.net">Books</a></li>
        <li><a href="http://fsharpworks.com/workshops.html">Trainings</a></li>
        <li><a href="http://fsharpworks.com">Consulting</a></li>
        <li><a href="http://tomasp.net/academic">Research</a></li>
      </ul>
    </section>

    </nav></div>
  </header>
  
  
<div class="row">
	<div class="large-8 columns main-content">
    <content>
      

<h1>Library patterns: Why frameworks are evil</h1>

<p>This article is a follow up to my previous blog post about <a href="http://tomasp.net/blog/2015/library-layers">functional library 
design</a>, but you do not need to read the previous one,
because I'll focus on a different topic.</p>

<p>In the previous article, I wrote about a couple of principles that I find useful when 
designing libraries in a functional style. This follows from my experience with building
F# libraries, but the ideas are quite general and can be useful in any programming language.
Previously, I wrote how <em>multiple layers of abstraction</em> let you build libraries that make
80% of scenarios easy while still supporting the more interesting use cases.</p>

<p>In this article, I'll focus on two other points from the list - how to design <em>composable</em>
libraries and how (and why) to <em>avoid callbacks</em> in library design. As the title suggests, this
boils down to one thing - build <strong>libraries</strong> rather than <strong>frameworks</strong>!</p>

<h2>Frameworks vs. Libraries</h2>

<img src="diagram-narrow.png" style="float:right;margin:0px 0px 10px 20px" />

<p>What is a difference between a framework and a library? The key difference is how you can use
them and what kind of code you need to write.</p>

<ul>
<li><p><strong>Frameworks.</strong> When using a framework, the framework is in charge of running the system. 
It defines some extensibility points (interfaces) where you need to put your
implementation.</p></li>
<li><p><strong>Libraries.</strong> When using a library, you are in charge of running the system. The library defines
some points through which you can access it (functions and types) and your code can
call it as it needs.</p></li>
</ul>

<p>You can see the difference in the diagram. A framework defines a structure that you have to 
fill, while library has some structure that you have to build around.</p>

<p>Of course, the separation between the two is not complete. Some components have aspects of both - 
you call it as a library, but it has some holes (e.g. an interface) that you have to fill.</p>

<h2>Why are frameworks evil?</h2>

<p>If you look at the diagram above, you can already see some of the problems with frameworks. 
In this section, I'd like to say a few things about three of the problems (before looking
at ways to avoid those in the next section).</p>

<h3>Frameworks do not compose</h3>

<img src="compose.png" style="float:right;margin:35px 0px 35px 10px" />

<p>Perhaps the biggest and the most obvious problem with frameworks is that they cannot be composed.
When you have two frameworks, they both force you to fill in a specific hole. But there is usually
no way to fit one framework inside another (and it is usually not clear which one should be
the one on the outside and which one should be on the inside).</p>

<p>With libraries, the situation is different. You are in control, so your program can easily call
multiple libraries. This may have some cost - you may need to write more complex code around the
library end-points - but it is usually possible.</p>

<blockquote>
  <p><strong>Theoretical side note</strong></p>

  <p>I do not claim that there is any theoretical basis for this, 
but frameworks seem to be a bit like monads. When you're out of a monad, you can "get
inside" using <em>unit</em>. Then you can do various things within the monad, but you can
never "get out". Frameworks are similar.</p>

  <p>It is quite well known that composing monads is hard (just like composing frameworks).
If you have monads <span class="math">\(M_1\)</span> and <span class="math">\(M_2\)</span>, you can compose them when you have an operation
<span class="math">\(M_1 (M_2~\alpha) \rightarrow M_2 (M_1~\alpha)\)</span>, i.e. you can switch the order in which 
they are wrapped. Can something similar be defined for frameworks?</p>
</blockquote>

<h3>Frrameworks are hard to explore</h3>

<p>Another big problem with frameworks is that they are difficult to test and explore. In F#,
it is very useful to load a library into F# Interactive and try running it with various 
inputs to see what the library does. For example you can use the web development library 
<a href="http://suave.io/">Suave</a> to start a simple web server like this:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="c">// Reference the library &amp; open namespaces</span>
<span class="prep">#r</span> <span class="s">&quot;</span><span class="s">Suave</span><span class="s">.</span><span class="s">0</span><span class="s">.</span><span class="s">25</span><span class="s">.</span><span class="s">0</span><span class="s">/</span><span class="s">lib</span><span class="s">/</span><span class="s">net40</span><span class="s">/</span><span class="s">Suave</span><span class="s">.</span><span class="s">dll</span><span class="s">&quot;</span>
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs1', 1)" onmouseover="showTip(event, 'fs1', 1)" class="i">Suave</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs2', 2)" onmouseover="showTip(event, 'fs2', 2)" class="i">Web</span> 
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs1', 3)" onmouseover="showTip(event, 'fs1', 3)" class="i">Suave</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs3', 4)" onmouseover="showTip(event, 'fs3', 4)" class="i">Http</span>
 
<span class="c">// Start a simple web server printing hello</span>
<span onmouseout="hideTip(event, 'fs4', 5)" onmouseover="showTip(event, 'fs4', 5)" class="i">startWebServer</span> <span onmouseout="hideTip(event, 'fs5', 6)" onmouseover="showTip(event, 'fs5', 6)" class="i">defaultConfig</span> <span class="o">&lt;|</span> <span class="k">fun</span> <span onmouseout="hideTip(event, 'fs6', 7)" onmouseover="showTip(event, 'fs6', 7)" class="i">ctx</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs7', 8)" onmouseover="showTip(event, 'fs7', 8)" class="i">async</span> {
  <span class="k">let</span> <span onmouseout="hideTip(event, 'fs8', 9)" onmouseover="showTip(event, 'fs8', 9)" class="i">whoOpt</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs6', 10)" onmouseover="showTip(event, 'fs6', 10)" class="i">ctx</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs9', 11)" onmouseover="showTip(event, 'fs9', 11)" class="i">request</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs10', 12)" onmouseover="showTip(event, 'fs10', 12)" class="i">queryParam</span> <span class="s">&quot;</span><span class="s">who</span><span class="s">&quot;</span>
  <span class="k">let</span> <span onmouseout="hideTip(event, 'fs11', 13)" onmouseover="showTip(event, 'fs11', 13)" class="i">message</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs12', 14)" onmouseover="showTip(event, 'fs12', 14)" class="i">sprintf</span> <span class="s">&quot;</span><span class="s">Hello</span><span class="s"> </span><span class="s">%</span><span class="s">s</span><span class="s">&quot;</span> (<span onmouseout="hideTip(event, 'fs13', 15)" onmouseover="showTip(event, 'fs13', 15)" class="i">defaultArg</span> <span onmouseout="hideTip(event, 'fs8', 16)" onmouseover="showTip(event, 'fs8', 16)" class="i">whoOpt</span> <span class="s">&quot;</span><span class="s">world</span><span class="s">&quot;</span>)
  <span class="k">return!</span> <span onmouseout="hideTip(event, 'fs6', 17)" onmouseover="showTip(event, 'fs6', 17)" class="i">ctx</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs14', 18)" onmouseover="showTip(event, 'fs14', 18)" class="i">Successful</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs15', 19)" onmouseover="showTip(event, 'fs15', 19)" class="i">OK</span> <span onmouseout="hideTip(event, 'fs11', 20)" onmouseover="showTip(event, 'fs11', 20)" class="i">message</span> }</pre>
</td>
</tr>
</table>

<p>The snippet loads the library and then calls <code>startWebServer</code> with a default configuration
and a function to handle requests (the function gets the query parameter <code>who</code> and prints
a greeting).</p>

<p>This kind of usage is extremely useful, because it lets the user experiment with the library
quickly. You can try calling <code>startWebServer</code> with different kinds of parameters and see what
it does (or, for other functions, see what it returns).</p>

<blockquote>
  <p><strong>Theoretical side note</strong></p>

  <p>The difference between libraries and frameworks is pretty much the same as the difference
between calling a function and having to provide a function as an argument:</p>

<p><span class="math">\[\tag{library}
lib : \tau_1 \rightarrow \tau_2\]</span></p>

<p><span class="math">\[\tag{framework}
fwk : (\sigma_2 \rightarrow \sigma_1) \rightarrow unit\]</span></p>

  <p>In the <strong>library</strong> case, you need to create a <span class="math">\(\tau_1\)</span> value so that you can call the <span class="math">\(lib\)</span> function.
Sometimes, the library gives you other functions that create <span class="math">\(\tau_1\)</span> (in which case, you just need 
to find the first function of the chain to call). When writing code interactively, you can try to 
create various <span class="math">\(\tau_1\)</span> values, run the function and see what it returns. This gives you an easy way
to explore how the library behaves (and how to call it to get what you need). It also makes code that
uses libraries easy to test.</p>

  <p>In the <strong>framework</strong> case, the situation is more difficult. You have to write a function that accepts
<span class="math">\(\sigma_2\)</span> and produces <span class="math">\(\sigma_1\)</span>. The first problem is that you do not quite know what <span class="math">\(\sigma_2\)</span> value are
you going to get in different cases. In a perfect world <em>"invalid values are not representable"</em>, but in
reality, you want to start writing code that handles the most common cases first. Similarly, it is hard
to understand (and explore) what kind of <span class="math">\(\sigma_1\)</span> values you should produce to get the behaviour you want.</p>
</blockquote>

<p>Now, if you look back at my Suave example, you might be wondering whether this is a library (we call a function)
or a framework (we specify a function that is called). In fact, the above example demonstrates both aspects.
As I'll say later, this instance of "framework" structure is not actually a bad thing (see the sections
on callbacks and <code>async</code> below).</p>

<h3>Frameworks shape how you code</h3>

<p>The next problem with frameworks is that they control the structure of your code. The typical example of 
this is when you are using a framework that requires you to inherit from some abstract base class and
implement specific methods. For example the <a href="https://msdn.microsoft.com/en-us/library/microsoft.xna.framework.game_members.aspx">Game class in the XNA Framework</a>
looks something like this (I know that XNA is dead, but the patter is used in other similar frameworks):</p>

<pre lang="csharp"><span class="k">class</span> Game {
  <span class="k">abstract</span> <span class="k">void</span> Initialize();
  <span class="k">abstract</span> <span class="k">void</span> Draw(DrawingContext ctx);
  <span class="k">abstract</span> <span class="k">void</span> Update();
}</pre>

<p>In <code>Initialize</code>, you are supposed to load any resources that your game might need; <code>Update</code> is called
repeatedly to calculate the next state and <code>Draw</code> is called when the screen needs to be updated. The
interface is pretty much designed to an imperative programming model, so you'll end up writing something
like the next snippet. Here, we're writing a silly Mario game where Mario just slowly walks to the right:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">type</span> <span onmouseout="hideTip(event, 'fs16', 21)" onmouseover="showTip(event, 'fs16', 21)" class="i">MyGame</span>() <span class="o">=</span>
  <span class="k">inherit</span> <span onmouseout="hideTip(event, 'fs17', 22)" onmouseover="showTip(event, 'fs17', 22)" class="i">Xna</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs18', 23)" onmouseover="showTip(event, 'fs18', 23)" class="i">Game</span>()
  <span class="k">let</span> <span class="k">mutable</span> <span onmouseout="hideTip(event, 'fs19', 24)" onmouseover="showTip(event, 'fs19', 24)" class="i">x</span> <span class="o">=</span> <span class="n">0</span>
  <span class="k">let</span> <span class="k">mutable</span> <span onmouseout="hideTip(event, 'fs20', 25)" onmouseover="showTip(event, 'fs20', 25)" class="i">mario</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs21', 26)" onmouseover="showTip(event, 'fs21', 26)" class="i">None</span>

  <span class="k">override</span> <span onmouseout="hideTip(event, 'fs22', 27)" onmouseover="showTip(event, 'fs22', 27)" class="i">this</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs23', 28)" onmouseover="showTip(event, 'fs23', 28)" class="i">Initialize</span>() <span class="o">=</span> 
    <span onmouseout="hideTip(event, 'fs20', 29)" onmouseover="showTip(event, 'fs20', 29)" class="i">mario</span> <span class="o">&lt;-</span> <span onmouseout="hideTip(event, 'fs24', 30)" onmouseover="showTip(event, 'fs24', 30)" class="i">Some</span>(<span onmouseout="hideTip(event, 'fs25', 31)" onmouseover="showTip(event, 'fs25', 31)" class="i">Image</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs26', 32)" onmouseover="showTip(event, 'fs26', 32)" class="i">Load</span>(<span class="s">&quot;</span><span class="s">mario</span><span class="s">.</span><span class="s">png</span><span class="s">&quot;</span>))
  <span class="k">override</span> <span onmouseout="hideTip(event, 'fs22', 33)" onmouseover="showTip(event, 'fs22', 33)" class="i">this</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs27', 34)" onmouseover="showTip(event, 'fs27', 34)" class="i">Update</span>() <span class="o">=</span>
    <span onmouseout="hideTip(event, 'fs19', 35)" onmouseover="showTip(event, 'fs19', 35)" class="i">x</span> <span class="o">&lt;-</span> <span onmouseout="hideTip(event, 'fs19', 36)" onmouseover="showTip(event, 'fs19', 36)" class="i">x</span> <span class="o">+</span> <span class="n">1</span>
  <span class="k">override</span> <span onmouseout="hideTip(event, 'fs22', 37)" onmouseover="showTip(event, 'fs22', 37)" class="i">this</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs28', 38)" onmouseover="showTip(event, 'fs28', 38)" class="i">Draw</span>(<span onmouseout="hideTip(event, 'fs29', 39)" onmouseover="showTip(event, 'fs29', 39)" class="i">ctx</span>) <span class="o">=</span>
    <span onmouseout="hideTip(event, 'fs20', 40)" onmouseover="showTip(event, 'fs20', 40)" class="i">mario</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs30', 41)" onmouseover="showTip(event, 'fs30', 41)" class="i">Option</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs31', 42)" onmouseover="showTip(event, 'fs31', 42)" class="i">iter</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs32', 43)" onmouseover="showTip(event, 'fs32', 43)" class="i">mario</span> <span class="k">-&gt;</span>
      <span onmouseout="hideTip(event, 'fs29', 44)" onmouseover="showTip(event, 'fs29', 44)" class="i">ctx</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs33', 45)" onmouseover="showTip(event, 'fs33', 45)" class="i">Draw</span>(<span onmouseout="hideTip(event, 'fs19', 46)" onmouseover="showTip(event, 'fs19', 46)" class="i">x</span>, <span class="n">0</span>, <span onmouseout="hideTip(event, 'fs32', 47)" onmouseover="showTip(event, 'fs32', 47)" class="i">mario</span>))</pre>
</td>
</tr>
</table>

<p>The structure of the framework does not make it particularly easy to write the code in a nice way. Here,
I just did the most direct possible implementation. The mutable field <code>x</code> represent Mario's location and
<code>mario</code> is an <code>option&lt;Image&gt;</code> value for storing the resource.</p>

<p>You might say that this would be nicer in C# (e.g. I had to use <code>option</code> value because all F# fields have
to be initialized), but that is only true if you ignore all checking. The fact that we use <code>option</code> value
is actually making the code safer (because we cannot accidentally use <code>mario</code> in <code>Draw</code> if it was not 
initialized). Or does the framework <em>guaratnee</em> that <code>Initialize</code> will be called before <code>Draw</code>? Well, how
are we supposed to know that?</p>

<h2>How to avoid framework smells</h2>

<p>I hope I convinced you that you should avoid building <em>frameworks</em> and create <em>libraries</em> instead. But I
did not give any concrete tips how to do that. In the rest of the article, I look at a couple of concrete
points.</p>

<h3>Support interactive exploration</h3>

<p>Even if you're not writing your library in F#, you should use F# Interactive to be able to call it 
interactively! F# is not just <a href="http://fsprojects.github.io/ProjectScaffold/writing-docs.html">great for documenting your library</a>,
but writing an interactive script is a great way to make sure that your library is easy to call (if you're
on the .NET platform, the other option is <a href="http://www.linqpad.net/">LINQPad</a>).</p>

<p>To give two examples of what I mean, the following snippet shows how you can use the <a href="http://tpetricek.github.io/FSharp.Formatting/">F# Formatting 
library</a> to turn a folder with documentation containing
F# Script files and Markdown documents into HTML, or how to process a single file:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
<span class="l">7: </span>
<span class="l">8: </span>
<span class="l">9: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="prep">#r</span> <span class="s">&quot;</span><span class="s">FSharp</span><span class="s">.</span><span class="s">Literate</span><span class="s">.</span><span class="s">dll</span><span class="s">&quot;</span>
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs34', 48)" onmouseover="showTip(event, 'fs34', 48)" class="i">FSharp</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs35', 49)" onmouseover="showTip(event, 'fs35', 49)" class="i">Literate</span>

<span class="c">// Process an entire folder</span>
<span onmouseout="hideTip(event, 'fs36', 50)" onmouseover="showTip(event, 'fs36', 50)" class="i">Literate</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs37', 51)" onmouseover="showTip(event, 'fs37', 51)" class="i">ProcessDirectory</span>(<span class="s">&quot;</span><span class="s">C</span><span class="s">:</span><span class="s">/</span><span class="s">demo</span><span class="s">/</span><span class="s">docs</span><span class="s">&quot;</span>)

<span class="c">// Process two individual documents</span>
<span onmouseout="hideTip(event, 'fs36', 52)" onmouseover="showTip(event, 'fs36', 52)" class="i">Literate</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs38', 53)" onmouseover="showTip(event, 'fs38', 53)" class="i">ProcessMarkdown</span>(<span class="s">&quot;</span><span class="s">C</span><span class="s">:</span><span class="s">/</span><span class="s">demo</span><span class="s">/</span><span class="s">docs</span><span class="s">/</span><span class="s">sample</span><span class="s">.</span><span class="s">md</span><span class="s">&quot;</span>)
<span onmouseout="hideTip(event, 'fs36', 54)" onmouseover="showTip(event, 'fs36', 54)" class="i">Literate</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs39', 55)" onmouseover="showTip(event, 'fs39', 55)" class="i">ProcessScriptFile</span>(<span class="s">&quot;</span><span class="s">C</span><span class="s">:</span><span class="s">/</span><span class="s">demo</span><span class="s">/</span><span class="s">docs</span><span class="s">/</span><span class="s">sample</span><span class="s">.</span><span class="s">fsx</span><span class="s">&quot;</span>)</pre>
</td>
</tr>
</table>

<p>The idea is that you just need to reference the library, open the namespace and find the <code>Literate</code> 
type as the entry-point. Once you have that, you can use "." and see what is available!</p>

<p>I think all good libraries should support this kind of usage. As another example, let's look at 
<a href="http://funscript.info/">FunScript</a>, which translates F# code to JavaScript. Typically, you'd use
this as part of some web framework, but it works just fine without that too. The following generates
JavaScript for simple async loop that increments the number in the page <code>&lt;title&gt;</code> every second:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="prep">#r</span> <span class="s">&quot;</span><span class="s">FunScript</span><span class="s">.</span><span class="s">dll</span><span class="s">&quot;</span>
<span class="prep">#r</span> <span class="s">&quot;</span><span class="s">FunScript</span><span class="s">.</span><span class="s">TypeScript</span><span class="s">.</span><span class="s">Binding</span><span class="s">.</span><span class="s">lib</span><span class="s">.</span><span class="s">dll</span><span class="s">&quot;</span>
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs40', 56)" onmouseover="showTip(event, 'fs40', 56)" class="i">FunScript</span>
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs40', 57)" onmouseover="showTip(event, 'fs40', 57)" class="i">FunScript</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs41', 58)" onmouseover="showTip(event, 'fs41', 58)" class="i">TypeScript</span>

<span onmouseout="hideTip(event, 'fs42', 59)" onmouseover="showTip(event, 'fs42', 59)" class="i">Compiler</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs43', 60)" onmouseover="showTip(event, 'fs43', 60)" class="i">compile</span> 
  &lt;@ <span class="k">let</span> <span class="k">rec</span> <span onmouseout="hideTip(event, 'fs44', 61)" onmouseover="showTip(event, 'fs44', 61)" class="i">loop</span> <span onmouseout="hideTip(event, 'fs45', 62)" onmouseover="showTip(event, 'fs45', 62)" class="i">n</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs46', 63)" onmouseover="showTip(event, 'fs46', 63)" class="i">Async</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs47', 64)" onmouseover="showTip(event, 'fs47', 64)" class="i">unit</span><span class="o">&gt;</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs7', 65)" onmouseover="showTip(event, 'fs7', 65)" class="i">async</span> {
        <span onmouseout="hideTip(event, 'fs48', 66)" onmouseover="showTip(event, 'fs48', 66)" class="i">Globals</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs49', 67)" onmouseover="showTip(event, 'fs49', 67)" class="i">window</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs50', 68)" onmouseover="showTip(event, 'fs50', 68)" class="i">document</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs51', 69)" onmouseover="showTip(event, 'fs51', 69)" class="i">title</span> <span class="o">&lt;-</span> <span onmouseout="hideTip(event, 'fs52', 70)" onmouseover="showTip(event, 'fs52', 70)" class="i">string</span> <span onmouseout="hideTip(event, 'fs45', 71)" onmouseover="showTip(event, 'fs45', 71)" class="i">n</span>       
        <span class="k">do!</span> <span onmouseout="hideTip(event, 'fs46', 72)" onmouseover="showTip(event, 'fs46', 72)" class="i">Async</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs53', 73)" onmouseover="showTip(event, 'fs53', 73)" class="i">Sleep</span>(<span class="n">1000</span>)
        <span class="k">return!</span> <span onmouseout="hideTip(event, 'fs44', 74)" onmouseover="showTip(event, 'fs44', 74)" class="i">loop</span> (<span onmouseout="hideTip(event, 'fs45', 75)" onmouseover="showTip(event, 'fs45', 75)" class="i">n</span> <span class="o">+</span> <span class="n">1</span>) }
      <span onmouseout="hideTip(event, 'fs44', 76)" onmouseover="showTip(event, 'fs44', 76)" class="i">loop</span> <span class="n">0</span> @&gt;</pre>
</td>
</tr>
</table>

<p>Again, we just reference the library (this time, we also reference bindings for DOM) and then we
call one function - the <code>compile</code> function takes an F# quotation. Once you discover it, you can
experiment with what kind of things it can handle! The above demo shows a nice support for the
F# <code>async { .. }</code> and for bindings that let you access the DOM.</p>

<h3>Use only simple callbacks</h3>

<p>When I talked about frameworks in the theoretical side note above, I said that framework is, 
in principle, anything that accepts a function as an argument. So, am I saying that you should not
use higher-order functions? Of course not!</p>

<p>Compare the following two simple snippets - the first one uses the standard list processing 
functions and the second one reads some input (using the first function), validates it and 
then processes it (using the second function):</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="c">// Standard list-processing functions</span>
[ <span class="n">1</span> <span class="o">..</span> <span class="n">10</span> ]
<span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs54', 77)" onmouseover="showTip(event, 'fs54', 77)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs55', 78)" onmouseover="showTip(event, 'fs55', 78)" class="i">filter</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs45', 79)" onmouseover="showTip(event, 'fs45', 79)" class="i">n</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs45', 80)" onmouseover="showTip(event, 'fs45', 80)" class="i">n</span><span class="o">%</span><span class="n">3</span> <span class="o">=</span> <span class="n">0</span>)
<span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs54', 81)" onmouseover="showTip(event, 'fs54', 81)" class="i">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs56', 82)" onmouseover="showTip(event, 'fs56', 82)" class="i">map</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs45', 83)" onmouseover="showTip(event, 'fs45', 83)" class="i">n</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs45', 84)" onmouseover="showTip(event, 'fs45', 84)" class="i">n</span><span class="o">*</span><span class="n">10</span>)

<span class="c">// Calls the first function to read input, validates </span>
<span class="c">// it and then calls second function to process it</span>
<span onmouseout="hideTip(event, 'fs57', 85)" onmouseover="showTip(event, 'fs57', 85)" class="i">readAndProcess</span>
  (<span class="k">fun</span> () <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs58', 86)" onmouseover="showTip(event, 'fs58', 86)" class="i">File</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs59', 87)" onmouseover="showTip(event, 'fs59', 87)" class="i">ReadAllText</span>(<span class="s">&quot;</span><span class="s">C</span><span class="s">:</span><span class="s">/</span><span class="s">demo</span><span class="s">.</span><span class="s">txt</span><span class="s">&quot;</span>))
  (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs60', 88)" onmouseover="showTip(event, 'fs60', 88)" class="i">s</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs60', 89)" onmouseover="showTip(event, 'fs60', 89)" class="i">s</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs61', 90)" onmouseover="showTip(event, 'fs61', 90)" class="i">ToUpper</span>())</pre>
</td>
</tr>
</table>

<p>There are two differences between the first and second example. In case of list functions, you
always specify just a single function as an argument. Furthermore, the functions should never 
be stateful.</p>

<p>In the second case, we are specifying two functions. To me, this is a sign that the function may
be more complicated than it needs to be. Secondly, <code>readAndProcess</code> requires us to return <code>string</code>
state from the first function and then take <code>string</code> as the input of the second function. This is
another potential problem. What if we needed to pass some other state from the first function to
the second one?</p>

<p>I'm obviously looking at a simplified case here, but let's look what might be going on inside 
<code>readAndProcess</code>. The function might be handling some exceptions and checking that the input
is valid before calling the second argument:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs57', 91)" onmouseover="showTip(event, 'fs57', 91)" class="i">readAndProcess</span> <span onmouseout="hideTip(event, 'fs62', 92)" onmouseover="showTip(event, 'fs62', 92)" class="i">readInput</span> <span onmouseout="hideTip(event, 'fs63', 93)" onmouseover="showTip(event, 'fs63', 93)" class="i">processInput</span> <span class="o">=</span>
  <span class="k">try</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs64', 94)" onmouseover="showTip(event, 'fs64', 94)" class="i">input</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs62', 95)" onmouseover="showTip(event, 'fs62', 95)" class="i">readInput</span>()
    <span class="k">if</span> <span onmouseout="hideTip(event, 'fs64', 96)" onmouseover="showTip(event, 'fs64', 96)" class="i">input</span> <span class="o">=</span> <span class="k">null</span> <span class="o">||</span> <span onmouseout="hideTip(event, 'fs64', 97)" onmouseover="showTip(event, 'fs64', 97)" class="i">input</span> <span class="o">=</span> <span class="s">&quot;</span><span class="s">&quot;</span> <span class="k">then</span> <span onmouseout="hideTip(event, 'fs21', 98)" onmouseover="showTip(event, 'fs21', 98)" class="i">None</span>
    <span class="k">else</span> <span onmouseout="hideTip(event, 'fs24', 99)" onmouseover="showTip(event, 'fs24', 99)" class="i">Some</span>(<span onmouseout="hideTip(event, 'fs63', 100)" onmouseover="showTip(event, 'fs63', 100)" class="i">processInput</span> <span onmouseout="hideTip(event, 'fs64', 101)" onmouseover="showTip(event, 'fs64', 101)" class="i">input</span>)
  <span class="k">with</span> <span class="o">:?</span> <span onmouseout="hideTip(event, 'fs65', 102)" onmouseover="showTip(event, 'fs65', 102)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs66', 103)" onmouseover="showTip(event, 'fs66', 103)" class="i">IO</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs67', 104)" onmouseover="showTip(event, 'fs67', 104)" class="i">IOException</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs21', 105)" onmouseover="showTip(event, 'fs21', 105)" class="i">None</span></pre>
</td>
</tr>
</table>

<p>How can we improve this abstraction? First of all, the function really serves two purposes. First,
it handles exceptions (in a silly way, but this is a toy sample). Second, it validates the input.
We can split it into two functions:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs68', 106)" onmouseover="showTip(event, 'fs68', 106)" class="i">ignoreIOErrors</span> <span onmouseout="hideTip(event, 'fs69', 107)" onmouseover="showTip(event, 'fs69', 107)" class="i">f</span> <span class="o">=</span>
  <span class="k">try</span> <span onmouseout="hideTip(event, 'fs24', 108)" onmouseover="showTip(event, 'fs24', 108)" class="i">Some</span> (<span onmouseout="hideTip(event, 'fs69', 109)" onmouseover="showTip(event, 'fs69', 109)" class="i">f</span>())
  <span class="k">with</span> <span class="o">:?</span> <span onmouseout="hideTip(event, 'fs65', 110)" onmouseover="showTip(event, 'fs65', 110)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs66', 111)" onmouseover="showTip(event, 'fs66', 111)" class="i">IO</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs67', 112)" onmouseover="showTip(event, 'fs67', 112)" class="i">IOException</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs21', 113)" onmouseover="showTip(event, 'fs21', 113)" class="i">None</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs70', 114)" onmouseover="showTip(event, 'fs70', 114)" class="i">validateInput</span> <span onmouseout="hideTip(event, 'fs64', 115)" onmouseover="showTip(event, 'fs64', 115)" class="i">input</span> <span class="o">=</span> 
  <span class="k">if</span> <span onmouseout="hideTip(event, 'fs64', 116)" onmouseover="showTip(event, 'fs64', 116)" class="i">input</span> <span class="o">=</span> <span class="k">null</span> <span class="o">||</span> <span onmouseout="hideTip(event, 'fs64', 117)" onmouseover="showTip(event, 'fs64', 117)" class="i">input</span> <span class="o">=</span> <span class="s">&quot;</span><span class="s">&quot;</span> <span class="k">then</span> <span onmouseout="hideTip(event, 'fs21', 118)" onmouseover="showTip(event, 'fs21', 118)" class="i">None</span> <span class="k">else</span> <span onmouseout="hideTip(event, 'fs24', 119)" onmouseover="showTip(event, 'fs24', 119)" class="i">Some</span>(<span onmouseout="hideTip(event, 'fs64', 120)" onmouseover="showTip(event, 'fs64', 120)" class="i">input</span>)</pre>
</td>
</tr>
</table>

<p>Now, <code>validateInput</code> became just an ordinary function that returns <code>Some</code> if the input was valid.
The <code>ignoreIOErrors</code> function still takes a function as an argument - in this case, it makes sense,
because exception handling is a typical example of the <a href="http://blog.enfranchisedmind.com/2007/07/the-hole-in-the-middle-pattern/">Hole in the Middle pattern</a>.
Using the new functions, we can write:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span onmouseout="hideTip(event, 'fs68', 121)" onmouseover="showTip(event, 'fs68', 121)" class="i">ignoreIOErrors</span> (<span class="k">fun</span> () <span class="k">-&gt;</span>
  <span class="k">let</span> <span onmouseout="hideTip(event, 'fs64', 122)" onmouseover="showTip(event, 'fs64', 122)" class="i">input</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs58', 123)" onmouseover="showTip(event, 'fs58', 123)" class="i">File</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs59', 124)" onmouseover="showTip(event, 'fs59', 124)" class="i">ReadAllText</span>(<span class="s">&quot;</span><span class="s">C</span><span class="s">:</span><span class="s">/</span><span class="s">demo</span><span class="s">.</span><span class="s">txt</span><span class="s">&quot;</span>)
  <span onmouseout="hideTip(event, 'fs70', 125)" onmouseover="showTip(event, 'fs70', 125)" class="i">validateInput</span> <span onmouseout="hideTip(event, 'fs64', 126)" onmouseover="showTip(event, 'fs64', 126)" class="i">input</span> 
  <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs30', 127)" onmouseover="showTip(event, 'fs30', 127)" class="i">Option</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs71', 128)" onmouseover="showTip(event, 'fs71', 128)" class="i">map</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs72', 129)" onmouseover="showTip(event, 'fs72', 129)" class="i">valid</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs72', 130)" onmouseover="showTip(event, 'fs72', 130)" class="i">valid</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs61', 131)" onmouseover="showTip(event, 'fs61', 131)" class="i">ToUpper</span>() ))</pre>
</td>
</tr>
</table>

<p>If you try, you can still fit this on 3 lines, but the code is a bit longer and a bit more explicit.
However, I think that is actually a benefit, because you can see what is going on (and you can start
by calling <code>validateInput</code> interactively!) Also, if you like the <code>readAndProcess</code> function better, that's
fine - you can easily define it using the two above functions (but not the other way round!) So, your
library can provide <em>multiple levels of abstraction</em> as <a href="http://tomasp.net/blog/2015/library-layers/">discussed in my earlier article</a>.
But providing only the higher-level abstraction would be limiting.</p>

<p>To summarize, passing functions as arguments is not necessarily wrong, but be careful.
If a function takes more than one function as an argument, it might not be the best low-level
abstraaction. If the functions passed as arguments need to share and pass around some state, 
then you should definitely provide an alternative (in case the "default" state passing is
not what the caller needs).</p>

<h3>Inverting callbacks with events and async</h3>

<p>When discussing how frameworks shape your code, I used a simple game enginge as an example.
What could be done differently so that we do not need to use mutable fields and implement
a specific class? In F#, we can use <em>asynchronous workflows</em> and <em>event-based</em> programming
model instead.</p>

<p>This is more tricky for languages that do not have anything similar to computation 
expressions (or <a href="http://tomasp.net/blog/csharp-async.aspx/">iterators that can be used to fake this</a>),
but C# supports <code>await</code>, F# has computation expressions, Haskell has the <code>do</code> notation and in 
Python you can probably misuse generators.</p>

<p>The idea is that rather than writing virtual methods that need to be implemented, we'll expose
events that are triggered when the operation needs to be done. So, the interface for our <code>Game</code>
might look like this:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">type</span> <span onmouseout="hideTip(event, 'fs73', 132)" onmouseover="showTip(event, 'fs73', 132)" class="i">Game</span> <span class="o">=</span> 
  <span class="k">member</span> <span class="i">Update</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs74', 133)" onmouseover="showTip(event, 'fs74', 133)" class="i">IEvent</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs47', 134)" onmouseover="showTip(event, 'fs47', 134)" class="i">unit</span><span class="o">&gt;</span>
  <span class="k">member</span> <span class="i">Draw</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs74', 135)" onmouseover="showTip(event, 'fs74', 135)" class="i">IEvent</span><span class="o">&lt;</span><span class="i">DrawingContext</span><span class="o">&gt;</span>
  <span class="k">member</span> <span class="i">IsRunning</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs75', 136)" onmouseover="showTip(event, 'fs75', 136)" class="i">bool</span></pre>
</td>
</tr>
</table>

<p>Using F# async, we can now write the code differently. Going back to the original idea of frameworks vs.
libraries, we can write it so that we are in control what is going on! The following first initializes
the resources and the <code>Game</code> object and then it implements a loop (using recursive <code>async</code> blocks) that
waits for either <code>Update</code> or <code>Draw</code> event using the <a href="https://github.com/tpetricek/FSharp.AsyncExtensions">AwaitObservable</a>
method:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="c">// Initialize game and resources</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs76', 137)" onmouseover="showTip(event, 'fs76', 137)" class="i">game</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs77', 138)" onmouseover="showTip(event, 'fs77', 138)" class="i">Inverted</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs78', 139)" onmouseover="showTip(event, 'fs78', 139)" class="i">Game</span>()
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs79', 140)" onmouseover="showTip(event, 'fs79', 140)" class="i">mario</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs25', 141)" onmouseover="showTip(event, 'fs25', 141)" class="i">Image</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs26', 142)" onmouseover="showTip(event, 'fs26', 142)" class="i">Load</span>(<span class="s">&quot;</span><span class="s">mario</span><span class="s">.</span><span class="s">png</span><span class="s">&quot;</span>)

<span class="c">// Recursive loop that runs until the end of the game</span>
<span class="k">let</span> <span class="k">rec</span> <span onmouseout="hideTip(event, 'fs80', 143)" onmouseover="showTip(event, 'fs80', 143)" class="i">loop</span> <span onmouseout="hideTip(event, 'fs81', 144)" onmouseover="showTip(event, 'fs81', 144)" class="i">x</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs7', 145)" onmouseover="showTip(event, 'fs7', 145)" class="i">async</span> {
  <span class="k">if</span> <span onmouseout="hideTip(event, 'fs76', 146)" onmouseover="showTip(event, 'fs76', 146)" class="i">game</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs82', 147)" onmouseover="showTip(event, 'fs82', 147)" class="i">IsRunning</span> <span class="k">then</span>
    <span class="k">let!</span> <span onmouseout="hideTip(event, 'fs83', 148)" onmouseover="showTip(event, 'fs83', 148)" class="i">evt</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs46', 149)" onmouseover="showTip(event, 'fs46', 149)" class="i">Async</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs84', 150)" onmouseover="showTip(event, 'fs84', 150)" class="i">AwaitObservable</span>(<span onmouseout="hideTip(event, 'fs76', 151)" onmouseover="showTip(event, 'fs76', 151)" class="i">game</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs85', 152)" onmouseover="showTip(event, 'fs85', 152)" class="i">Update</span>, <span onmouseout="hideTip(event, 'fs76', 153)" onmouseover="showTip(event, 'fs76', 153)" class="i">game</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs86', 154)" onmouseover="showTip(event, 'fs86', 154)" class="i">Draw</span>) 
    <span class="k">match</span> <span onmouseout="hideTip(event, 'fs83', 155)" onmouseover="showTip(event, 'fs83', 155)" class="i">evt</span> <span class="k">with</span> 
    | <span onmouseout="hideTip(event, 'fs87', 156)" onmouseover="showTip(event, 'fs87', 156)" class="i">Choice1Of2</span>() <span class="k">-&gt;</span> 
        <span class="c">// Handle the &#39;Update&#39; event</span>
        <span class="k">return!</span> <span onmouseout="hideTip(event, 'fs80', 157)" onmouseover="showTip(event, 'fs80', 157)" class="i">loop</span> (<span onmouseout="hideTip(event, 'fs81', 158)" onmouseover="showTip(event, 'fs81', 158)" class="i">x</span> <span class="o">+</span> <span class="n">1</span>)
    | <span onmouseout="hideTip(event, 'fs88', 159)" onmouseover="showTip(event, 'fs88', 159)" class="i">Choice2Of2</span>(<span onmouseout="hideTip(event, 'fs29', 160)" onmouseover="showTip(event, 'fs29', 160)" class="i">ctx</span>) <span class="k">-&gt;</span> 
        <span class="c">// Handle the &#39;Draw&#39; event</span>
        <span onmouseout="hideTip(event, 'fs29', 161)" onmouseover="showTip(event, 'fs29', 161)" class="i">ctx</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs33', 162)" onmouseover="showTip(event, 'fs33', 162)" class="i">Draw</span>(<span onmouseout="hideTip(event, 'fs81', 163)" onmouseover="showTip(event, 'fs81', 163)" class="i">x</span>, <span class="n">0</span>, <span onmouseout="hideTip(event, 'fs79', 164)" onmouseover="showTip(event, 'fs79', 164)" class="i">mario</span>) 
        <span class="k">return!</span> <span onmouseout="hideTip(event, 'fs80', 165)" onmouseover="showTip(event, 'fs80', 165)" class="i">loop</span> <span onmouseout="hideTip(event, 'fs81', 166)" onmouseover="showTip(event, 'fs81', 166)" class="i">x</span> }

<span class="c">// Start the Game with x=0</span>
<span onmouseout="hideTip(event, 'fs80', 167)" onmouseover="showTip(event, 'fs80', 167)" class="i">loop</span> <span class="n">0</span>  </pre>
</td>
</tr>
</table>

<p>We cannot be fully in control, because we don't know when the system calls us
to update the game state and when it calls us to redraw the screen. But we can be
in control when it comes to initializing the resources, checking when the game is
running and waiting for one or the other event.</p>

<p>Using <code>async { .. }</code> is the key here. We can use <code>AwaitObservable</code> to say "resume
the computation when either <code>Update</code> or <code>Draw</code> is required". When the event happens,
we preform the required action (update state on line 12 or draw Mario on line 15)
and then continue. The nice thing is that you can easily extend this into a more
complex logic - for a nice example, see <a href="http://trelford.com/blog/post/FractalZoom.aspx">Phil Trelford's Fractal Zoom</a>.
The other option with similar properties would be to use <a href="http://www.developerfusion.com/article/139804/an-introduction-to-f-agents/">F# agents</a>,
which give you similar control over the logic.</p>

<p>So, we are now in control, but have we really gained much? If you're new to F#, 
then you'll no doubt find the above code confusing. The main thing is that, by reversing
the control, we can now easily write our own abstractions, which leads to the last point...</p>

<h3>Use multiple levels of abstraction</h3>

<p>As discussed in the <a href="http://tomasp.net/blog/2015/library-layers/">previous blog post</a>, a 
library should provide multiple layers of abstraction. The <code>Game</code> type that I used
in the previous snippet is a low-level abstraction - it is useful if you want to build
something more sophisticated and it gives you all the control you need. But most of
the time, you may actually want to write the game just as a pair of "draw" and "update"
functions.</p>

<p>This can easily be done, because we can just take the previous code snippet and extract
several parts into arguments:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs89', 168)" onmouseover="showTip(event, 'fs89', 168)" class="i">startGame</span> <span onmouseout="hideTip(event, 'fs90', 169)" onmouseover="showTip(event, 'fs90', 169)" class="i">draw</span> <span onmouseout="hideTip(event, 'fs91', 170)" onmouseover="showTip(event, 'fs91', 170)" class="i">update</span> <span onmouseout="hideTip(event, 'fs92', 171)" onmouseover="showTip(event, 'fs92', 171)" class="i">init</span> <span class="o">=</span>
  <span class="k">let</span> <span onmouseout="hideTip(event, 'fs93', 172)" onmouseover="showTip(event, 'fs93', 172)" class="i">game</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs77', 173)" onmouseover="showTip(event, 'fs77', 173)" class="i">Inverted</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs78', 174)" onmouseover="showTip(event, 'fs78', 174)" class="i">Game</span>()
  <span class="k">let</span> <span class="k">rec</span> <span onmouseout="hideTip(event, 'fs94', 175)" onmouseover="showTip(event, 'fs94', 175)" class="i">loop</span> <span onmouseout="hideTip(event, 'fs95', 176)" onmouseover="showTip(event, 'fs95', 176)" class="i">x</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs7', 177)" onmouseover="showTip(event, 'fs7', 177)" class="i">async</span> {
    <span class="k">if</span> <span onmouseout="hideTip(event, 'fs93', 178)" onmouseover="showTip(event, 'fs93', 178)" class="i">game</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs82', 179)" onmouseover="showTip(event, 'fs82', 179)" class="i">IsRunning</span> <span class="k">then</span>
      <span class="k">let!</span> <span onmouseout="hideTip(event, 'fs83', 180)" onmouseover="showTip(event, 'fs83', 180)" class="i">evt</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs46', 181)" onmouseover="showTip(event, 'fs46', 181)" class="i">Async</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs84', 182)" onmouseover="showTip(event, 'fs84', 182)" class="i">AwaitObservable</span>(<span onmouseout="hideTip(event, 'fs93', 183)" onmouseover="showTip(event, 'fs93', 183)" class="i">game</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs85', 184)" onmouseover="showTip(event, 'fs85', 184)" class="i">Update</span>, <span onmouseout="hideTip(event, 'fs93', 185)" onmouseover="showTip(event, 'fs93', 185)" class="i">game</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs86', 186)" onmouseover="showTip(event, 'fs86', 186)" class="i">Draw</span>) 
      <span class="k">match</span> <span onmouseout="hideTip(event, 'fs83', 187)" onmouseover="showTip(event, 'fs83', 187)" class="i">evt</span> <span class="k">with</span> 
      | <span onmouseout="hideTip(event, 'fs87', 188)" onmouseover="showTip(event, 'fs87', 188)" class="i">Choice1Of2</span>() <span class="k">-&gt;</span> <span class="k">return!</span> <span onmouseout="hideTip(event, 'fs94', 189)" onmouseover="showTip(event, 'fs94', 189)" class="i">loop</span> (<span onmouseout="hideTip(event, 'fs91', 190)" onmouseover="showTip(event, 'fs91', 190)" class="i">update</span> <span onmouseout="hideTip(event, 'fs95', 191)" onmouseover="showTip(event, 'fs95', 191)" class="i">x</span>)
      | <span onmouseout="hideTip(event, 'fs88', 192)" onmouseover="showTip(event, 'fs88', 192)" class="i">Choice2Of2</span>(<span onmouseout="hideTip(event, 'fs29', 193)" onmouseover="showTip(event, 'fs29', 193)" class="i">ctx</span>) <span class="k">-&gt;</span> 
          <span onmouseout="hideTip(event, 'fs90', 194)" onmouseover="showTip(event, 'fs90', 194)" class="i">draw</span> <span onmouseout="hideTip(event, 'fs95', 195)" onmouseover="showTip(event, 'fs95', 195)" class="i">x</span> <span onmouseout="hideTip(event, 'fs29', 196)" onmouseover="showTip(event, 'fs29', 196)" class="i">ctx</span>
          <span class="k">return!</span> <span onmouseout="hideTip(event, 'fs94', 197)" onmouseover="showTip(event, 'fs94', 197)" class="i">loop</span> <span onmouseout="hideTip(event, 'fs95', 198)" onmouseover="showTip(event, 'fs95', 198)" class="i">x</span> }
  <span onmouseout="hideTip(event, 'fs94', 199)" onmouseover="showTip(event, 'fs94', 199)" class="i">loop</span> <span onmouseout="hideTip(event, 'fs92', 200)" onmouseover="showTip(event, 'fs92', 200)" class="i">init</span></pre>
</td>
</tr>
</table>

<p>The <code>startGame</code> abstraction takes two functions as arugments together with an initial state.
The <code>update</code> function updates the state and the <code>draw</code> function draws the state using the
specified <code>DrawingContext</code>. Using these, we can now write our Mario sample in just 4 lines:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs79', 201)" onmouseover="showTip(event, 'fs79', 201)" class="i">mario</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs25', 202)" onmouseover="showTip(event, 'fs25', 202)" class="i">Image</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs26', 203)" onmouseover="showTip(event, 'fs26', 203)" class="i">Load</span>(<span class="s">&quot;</span><span class="s">mario</span><span class="s">.</span><span class="s">png</span><span class="s">&quot;</span>)
<span class="n">0</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs89', 204)" onmouseover="showTip(event, 'fs89', 204)" class="i">startGame</span> 
  (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs81', 205)" onmouseover="showTip(event, 'fs81', 205)" class="i">x</span> <span onmouseout="hideTip(event, 'fs29', 206)" onmouseover="showTip(event, 'fs29', 206)" class="i">ctx</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs29', 207)" onmouseover="showTip(event, 'fs29', 207)" class="i">ctx</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs33', 208)" onmouseover="showTip(event, 'fs33', 208)" class="i">Draw</span>(<span onmouseout="hideTip(event, 'fs81', 209)" onmouseover="showTip(event, 'fs81', 209)" class="i">x</span>, <span class="n">0</span>, <span onmouseout="hideTip(event, 'fs79', 210)" onmouseover="showTip(event, 'fs79', 210)" class="i">mario</span>))
  (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs81', 211)" onmouseover="showTip(event, 'fs81', 211)" class="i">x</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs81', 212)" onmouseover="showTip(event, 'fs81', 212)" class="i">x</span> <span class="o">+</span> <span class="n">1</span>)</pre>
</td>
</tr>
</table>

<p>If you read the whole blog post, then you may be wondering whether I'm contradicting myself here!
Didn't I previously write that higher-order functions that take multiple functions (especially
when they share state) are evil frameworks? You're right, I said that! But let me clarify this:</p>

<p><em>It is fine to have easy-to-use operation that takes a couple of other functions as a
high-level abstraction, but there sould be a simple and more explicit alternative!</em></p>

<p>You can take the above 4 lines, look at the definition of <code>startGame</code> and turn them into the
14 lines of code we've seen earlier (excluding comments). So, you should be able to <em>get the control</em>
by taking one (not very deep) step under the cover. This is in contrast with building a fragile
scaffolding on top of a poorly designed library that is sometimes needed if you want to write
elegant code.</p>

<h3>Design composable libraries</h3>

<p>As I mentioned before, one of the main reasons why you should design libraries rather than 
frameworks is that libraries can be composed. If you are in control, you can choose which libraries
to use for which part of a problem. This might not always be easy, but with libraries, you at least 
have a chance!</p>

<p>I think there are no general rules on how to design libraries that compose well - perhaps one 
important point is that your types need to expose all important information that other libraries
(for similar purpose) would need if they wanted to create a similar data structure.</p>

<p>A good example here is <a href="https://www.nuget.org/packages/FsLab">FsLab</a>, which is a package that
brings together a number of data-science libraries for F# (including <a href="http://bluemountaincapital.github.io/Deedle">Deedle</a>,
<a href="http://numerics.mathdotnet.com/">Math.NET Numerics</a> and others). The FsLab package comes with
a single script that links a number of other libraries together (you can <a href="https://github.com/tpetricek/FsLab/blob/2c1d81d0502f03331c21242e2cef9386d0928990/src/FsLab.fsx#L82">see the source code
here</a>).</p>

<p>Two simple examples from the file are functions for converting from matrix to frame (<code>Matrix.toFrame</code>)
and the other way round (<code>Frame.toMatrix</code>):</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
<span class="l">7: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">module</span> <span class="i">Matrix</span> <span class="o">=</span>
  <span class="k">let</span> <span class="k">inline</span> <span onmouseout="hideTip(event, 'fs96', 213)" onmouseover="showTip(event, 'fs96', 213)" class="i">toFrame</span> <span onmouseout="hideTip(event, 'fs97', 214)" onmouseover="showTip(event, 'fs97', 214)" class="i">matrix</span> <span class="o">=</span> 
    <span onmouseout="hideTip(event, 'fs97', 215)" onmouseover="showTip(event, 'fs97', 215)" class="i">matrix</span> <span class="o">|&gt;</span> <span class="i">Matrix</span><span class="o">.</span><span class="i">toArray2</span> <span class="o">|&gt;</span> <span class="i">Frame</span><span class="o">.</span><span class="i">ofArray2D</span>

<span class="k">module</span> <span onmouseout="hideTip(event, 'fs98', 216)" onmouseover="showTip(event, 'fs98', 216)" class="i">Frame</span> <span class="o">=</span>
  <span class="k">let</span> <span class="k">inline</span> <span onmouseout="hideTip(event, 'fs99', 217)" onmouseover="showTip(event, 'fs99', 217)" class="i">toMatrix</span> <span onmouseout="hideTip(event, 'fs100', 218)" onmouseover="showTip(event, 'fs100', 218)" class="i">frame</span> <span class="o">=</span> 
    <span onmouseout="hideTip(event, 'fs100', 219)" onmouseover="showTip(event, 'fs100', 219)" class="i">frame</span> <span class="o">|&gt;</span> <span class="i">Frame</span><span class="o">.</span><span class="i">toArray2D</span> <span class="o">|&gt;</span> <span class="i">DenseMatrix</span><span class="o">.</span><span class="i">ofArray2</span></pre>
</td>
</tr>
</table>

<p>The solution here is quite simple, because both Deedle frame and Math.NET matrices can be converted
to/from a 2D array and so we just need to go from one to the other through an array. This looks very
simple, but I think that's the point - no matter what your library does, you should give the user all
the power they need to combine your librar with others (or replace some parts of it, if they don't 
like them!)</p>

<h1>Summary</h1>

<p>In this article, I looked at a number of functional library design principles. This is a second
article in this mini-series - the <a href="http://tomasp.net/blog/2015/library-layers">first one</a> contains
a longer introduction with a list of principles and then discusses <em>layers of abstraction</em>. In this
article, I talked about <em>composability</em> and <em>avoiding callbacks</em>. The two are closely related, because
heavily relying on callbacks breaks composability. I also related these two terms to libraries and
frameworks, because frameworks are, by design, non-composable.</p>

<p>To end on a lighter note, you can find frameworks not just in software, but also in ordinary life.
If you buy package holidays, you're buying a framework - they transport you to some place, put you
in a hotel, feed you and your activities have to fit into the shape provided by the framework (say,
go into the pool and swim there). If you travel independently, you are composing libraries. You have 
to book your flights, find your accommodation and arrange your program (all using different libraries).
It is more work, but you are in control - and you can arrange things exactly the way you need.</p>

<p>With traveling, I can see why some people prefer package holidays, but in software development,
there is no excuse for building frameworks!</p>

<div class="tip" id="fs1">namespace Suave</div>
<div class="tip" id="fs2">module Web<br /><br />from Suave</div>
<div class="tip" id="fs3">module Http<br /><br />from Suave</div>
<div class="tip" id="fs4">val startWebServer : config:Suave.Types.SuaveConfig -&gt; webpart:Suave.Types.WebPart -&gt; unit<br /><br />Full name: Suave.Web.startWebServer</div>
<div class="tip" id="fs5">val defaultConfig : Suave.Types.SuaveConfig<br /><br />Full name: Suave.Web.defaultConfig</div>
<div class="tip" id="fs6">val ctx : Suave.Types.HttpContext</div>
<div class="tip" id="fs7">val async : AsyncBuilder<br /><br />Full name: Microsoft.FSharp.Core.ExtraTopLevelOperators.async</div>
<div class="tip" id="fs8">val whoOpt : string option</div>
<div class="tip" id="fs9">Suave.Types.HttpContext.request: Suave.Types.HttpRequest</div>
<div class="tip" id="fs10">member Suave.Types.HttpRequest.queryParam : k:string -&gt; string option</div>
<div class="tip" id="fs11">val message : string</div>
<div class="tip" id="fs12">val sprintf : format:Printf.StringFormat&lt;&#39;T&gt; -&gt; &#39;T<br /><br />Full name: Microsoft.FSharp.Core.ExtraTopLevelOperators.sprintf</div>
<div class="tip" id="fs13">val defaultArg : arg:&#39;T option -&gt; defaultValue:&#39;T -&gt; &#39;T<br /><br />Full name: Microsoft.FSharp.Core.Operators.defaultArg</div>
<div class="tip" id="fs14">module Successful<br /><br />from Suave.Http</div>
<div class="tip" id="fs15">val OK : a:string -&gt; Suave.Types.WebPart<br /><br />Full name: Suave.Http.Successful.OK</div>
<div class="tip" id="fs16">Multiple items<br />type MyGame =<br />&#160;&#160;inherit Game<br />&#160;&#160;new : unit -&gt; MyGame<br />&#160;&#160;override Draw : ctx:DrawingContext -&gt; unit<br />&#160;&#160;override Initialize : unit -&gt; unit<br />&#160;&#160;override Update : unit -&gt; unit<br /><br />Full name: Library-frameworks_.MyGame<br /><br />--------------------<br />new : unit -&gt; MyGame</div>
<div class="tip" id="fs17">module Xna<br /><br />from Library-frameworks_</div>
<div class="tip" id="fs18">Multiple items<br />type Game =<br />&#160;&#160;new : unit -&gt; Game<br />&#160;&#160;abstract member Draw : DrawingContext -&gt; unit<br />&#160;&#160;abstract member Initialize : unit -&gt; unit<br />&#160;&#160;abstract member Update : unit -&gt; unit<br /><br />Full name: Library-frameworks_.Xna.Game<br /><br />--------------------<br />new : unit -&gt; Xna.Game</div>
<div class="tip" id="fs19">val mutable x : int</div>
<div class="tip" id="fs20">val mutable mario : Image option</div>
<div class="tip" id="fs21">union case Option.None: Option&lt;&#39;T&gt;</div>
<div class="tip" id="fs22">val this : MyGame</div>
<div class="tip" id="fs23">override MyGame.Initialize : unit -&gt; unit<br /><br />Full name: Library-frameworks_.MyGame.Initialize</div>
<div class="tip" id="fs24">union case Option.Some: Value: &#39;T -&gt; Option&lt;&#39;T&gt;</div>
<div class="tip" id="fs25">Multiple items<br />type Image =<br />&#160;&#160;new : unit -&gt; Image<br />&#160;&#160;static member Load : s:string -&gt; Image<br /><br />Full name: Library-frameworks_.Image<br /><br />--------------------<br />new : unit -&gt; Image</div>
<div class="tip" id="fs26">static member Image.Load : s:string -&gt; Image</div>
<div class="tip" id="fs27">override MyGame.Update : unit -&gt; unit<br /><br />Full name: Library-frameworks_.MyGame.Update</div>
<div class="tip" id="fs28">override MyGame.Draw : ctx:DrawingContext -&gt; unit<br /><br />Full name: Library-frameworks_.MyGame.Draw</div>
<div class="tip" id="fs29">val ctx : DrawingContext</div>
<div class="tip" id="fs30">module Option<br /><br />from Microsoft.FSharp.Core</div>
<div class="tip" id="fs31">val iter : action:(&#39;T -&gt; unit) -&gt; option:&#39;T option -&gt; unit<br /><br />Full name: Microsoft.FSharp.Core.Option.iter</div>
<div class="tip" id="fs32">val mario : Image</div>
<div class="tip" id="fs33">member DrawingContext.Draw : x:int * y:int * img:Image -&gt; unit</div>
<div class="tip" id="fs34">namespace FSharp</div>
<div class="tip" id="fs35">namespace FSharp.Literate</div>
<div class="tip" id="fs36">type Literate =<br />&#160;&#160;private new : unit -&gt; Literate<br />&#160;&#160;static member FormatLiterateNodes : doc:LiterateDocument * ?format:OutputKind * ?prefix:string * ?lineNumbers:bool * ?generateAnchors:bool -&gt; LiterateDocument<br />&#160;&#160;static member ParseMarkdownFile : path:string * ?formatAgent:CodeFormatAgent * ?compilerOptions:string * ?definedSymbols:#seq&lt;string&gt; * ?references:bool * ?fsiEvaluator:IFsiEvaluator -&gt; LiterateDocument<br />&#160;&#160;static member ParseMarkdownString : content:string * ?path:string * ?formatAgent:CodeFormatAgent * ?compilerOptions:string * ?definedSymbols:#seq&lt;string&gt; * ?references:bool * ?fsiEvaluator:IFsiEvaluator -&gt; LiterateDocument<br />&#160;&#160;static member ParseScriptFile : path:string * ?formatAgent:CodeFormatAgent * ?compilerOptions:string * ?definedSymbols:#seq&lt;string&gt; * ?references:bool * ?fsiEvaluator:IFsiEvaluator -&gt; LiterateDocument<br />&#160;&#160;static member ParseScriptString : content:string * ?path:string * ?formatAgent:CodeFormatAgent * ?compilerOptions:string * ?definedSymbols:#seq&lt;string&gt; * ?references:bool * ?fsiEvaluator:IFsiEvaluator -&gt; LiterateDocument<br />&#160;&#160;static member ProcessDirectory : inputDirectory:string * ?templateFile:string * ?outputDirectory:string * ?format:OutputKind * ?formatAgent:CodeFormatAgent * ?prefix:string * ?compilerOptions:string * ?lineNumbers:bool * ?references:bool * ?fsiEvaluator:IFsiEvaluator * ?replacements:(string * string) list * ?includeSource:bool * ?layoutRoots:string list * ?generateAnchors:bool * ?assemblyReferences:string list * ?processRecursive:bool -&gt; unit<br />&#160;&#160;static member ProcessMarkdown : input:string * ?templateFile:string * ?output:string * ?format:OutputKind * ?formatAgent:CodeFormatAgent * ?prefix:string * ?compilerOptions:string * ?lineNumbers:bool * ?references:bool * ?replacements:(string * string) list * ?includeSource:bool * ?layoutRoots:string list * ?generateAnchors:bool * ?assemblyReferences:string list -&gt; unit<br />&#160;&#160;static member ProcessScriptFile : input:string * ?templateFile:string * ?output:string * ?format:OutputKind * ?formatAgent:CodeFormatAgent * ?prefix:string * ?compilerOptions:string * ?lineNumbers:bool * ?references:bool * ?fsiEvaluator:IFsiEvaluator * ?replacements:(string * string) list * ?includeSource:bool * ?layoutRoots:string list * ?generateAnchors:bool * ?assemblyReferences:string list -&gt; unit<br />&#160;&#160;static member WriteHtml : doc:LiterateDocument * ?prefix:string * ?lineNumbers:bool * ?generateAnchors:bool -&gt; string<br />&#160;&#160;...<br /><br />Full name: FSharp.Literate.Literate</div>
<div class="tip" id="fs37">static member Literate.ProcessDirectory : inputDirectory:string * ?templateFile:string * ?outputDirectory:string * ?format:OutputKind * ?formatAgent:FSharp.CodeFormat.CodeFormatAgent * ?prefix:string * ?compilerOptions:string * ?lineNumbers:bool * ?references:bool * ?fsiEvaluator:IFsiEvaluator * ?replacements:(string * string) list * ?includeSource:bool * ?layoutRoots:string list * ?generateAnchors:bool * ?assemblyReferences:string list * ?processRecursive:bool -&gt; unit</div>
<div class="tip" id="fs38">static member Literate.ProcessMarkdown : input:string * ?templateFile:string * ?output:string * ?format:OutputKind * ?formatAgent:FSharp.CodeFormat.CodeFormatAgent * ?prefix:string * ?compilerOptions:string * ?lineNumbers:bool * ?references:bool * ?replacements:(string * string) list * ?includeSource:bool * ?layoutRoots:string list * ?generateAnchors:bool * ?assemblyReferences:string list -&gt; unit</div>
<div class="tip" id="fs39">static member Literate.ProcessScriptFile : input:string * ?templateFile:string * ?output:string * ?format:OutputKind * ?formatAgent:FSharp.CodeFormat.CodeFormatAgent * ?prefix:string * ?compilerOptions:string * ?lineNumbers:bool * ?references:bool * ?fsiEvaluator:IFsiEvaluator * ?replacements:(string * string) list * ?includeSource:bool * ?layoutRoots:string list * ?generateAnchors:bool * ?assemblyReferences:string list -&gt; unit</div>
<div class="tip" id="fs40">namespace FunScript</div>
<div class="tip" id="fs41">namespace FunScript.TypeScript</div>
<div class="tip" id="fs42">module Compiler<br /><br />from FunScript</div>
<div class="tip" id="fs43">val compile : expr:Quotations.Expr -&gt; string<br /><br />Full name: FunScript.Compiler.compile</div>
<div class="tip" id="fs44">val loop : (int -&gt; Async&lt;unit&gt;)</div>
<div class="tip" id="fs45">val n : int</div>
<div class="tip" id="fs46">Multiple items<br />type Async<br />static member AsBeginEnd : computation:(&#39;Arg -&gt; Async&lt;&#39;T&gt;) -&gt; (&#39;Arg * AsyncCallback * obj -&gt; IAsyncResult) * (IAsyncResult -&gt; &#39;T) * (IAsyncResult -&gt; unit)<br />static member AwaitEvent : event:IEvent&lt;&#39;Del,&#39;T&gt; * ?cancelAction:(unit -&gt; unit) -&gt; Async&lt;&#39;T&gt; (requires delegate and &#39;Del :&gt; Delegate)<br />static member AwaitIAsyncResult : iar:IAsyncResult * ?millisecondsTimeout:int -&gt; Async&lt;bool&gt;<br />static member AwaitTask : task:Task&lt;&#39;T&gt; -&gt; Async&lt;&#39;T&gt;<br />static member AwaitWaitHandle : waitHandle:WaitHandle * ?millisecondsTimeout:int -&gt; Async&lt;bool&gt;<br />static member CancelDefaultToken : unit -&gt; unit<br />static member Catch : computation:Async&lt;&#39;T&gt; -&gt; Async&lt;Choice&lt;&#39;T,exn&gt;&gt;<br />static member FromBeginEnd : beginAction:(AsyncCallback * obj -&gt; IAsyncResult) * endAction:(IAsyncResult -&gt; &#39;T) * ?cancelAction:(unit -&gt; unit) -&gt; Async&lt;&#39;T&gt;<br />static member FromBeginEnd : arg:&#39;Arg1 * beginAction:(&#39;Arg1 * AsyncCallback * obj -&gt; IAsyncResult) * endAction:(IAsyncResult -&gt; &#39;T) * ?cancelAction:(unit -&gt; unit) -&gt; Async&lt;&#39;T&gt;<br />static member FromBeginEnd : arg1:&#39;Arg1 * arg2:&#39;Arg2 * beginAction:(&#39;Arg1 * &#39;Arg2 * AsyncCallback * obj -&gt; IAsyncResult) * endAction:(IAsyncResult -&gt; &#39;T) * ?cancelAction:(unit -&gt; unit) -&gt; Async&lt;&#39;T&gt;<br />static member FromBeginEnd : arg1:&#39;Arg1 * arg2:&#39;Arg2 * arg3:&#39;Arg3 * beginAction:(&#39;Arg1 * &#39;Arg2 * &#39;Arg3 * AsyncCallback * obj -&gt; IAsyncResult) * endAction:(IAsyncResult -&gt; &#39;T) * ?cancelAction:(unit -&gt; unit) -&gt; Async&lt;&#39;T&gt;<br />static member FromContinuations : callback:((&#39;T -&gt; unit) * (exn -&gt; unit) * (OperationCanceledException -&gt; unit) -&gt; unit) -&gt; Async&lt;&#39;T&gt;<br />static member Ignore : computation:Async&lt;&#39;T&gt; -&gt; Async&lt;unit&gt;<br />static member OnCancel : interruption:(unit -&gt; unit) -&gt; Async&lt;IDisposable&gt;<br />static member Parallel : computations:seq&lt;Async&lt;&#39;T&gt;&gt; -&gt; Async&lt;&#39;T []&gt;<br />static member RunSynchronously : computation:Async&lt;&#39;T&gt; * ?timeout:int * ?cancellationToken:CancellationToken -&gt; &#39;T<br />static member Sleep : millisecondsDueTime:int -&gt; Async&lt;unit&gt;<br />static member Start : computation:Async&lt;unit&gt; * ?cancellationToken:CancellationToken -&gt; unit<br />static member StartAsTask : computation:Async&lt;&#39;T&gt; * ?taskCreationOptions:TaskCreationOptions * ?cancellationToken:CancellationToken -&gt; Task&lt;&#39;T&gt;<br />static member StartChild : computation:Async&lt;&#39;T&gt; * ?millisecondsTimeout:int -&gt; Async&lt;Async&lt;&#39;T&gt;&gt;<br />static member StartChildAsTask : computation:Async&lt;&#39;T&gt; * ?taskCreationOptions:TaskCreationOptions -&gt; Async&lt;Task&lt;&#39;T&gt;&gt;<br />static member StartImmediate : computation:Async&lt;unit&gt; * ?cancellationToken:CancellationToken -&gt; unit<br />static member StartWithContinuations : computation:Async&lt;&#39;T&gt; * continuation:(&#39;T -&gt; unit) * exceptionContinuation:(exn -&gt; unit) * cancellationContinuation:(OperationCanceledException -&gt; unit) * ?cancellationToken:CancellationToken -&gt; unit<br />static member SwitchToContext : syncContext:SynchronizationContext -&gt; Async&lt;unit&gt;<br />static member SwitchToNewThread : unit -&gt; Async&lt;unit&gt;<br />static member SwitchToThreadPool : unit -&gt; Async&lt;unit&gt;<br />static member TryCancelled : computation:Async&lt;&#39;T&gt; * compensation:(OperationCanceledException -&gt; unit) -&gt; Async&lt;&#39;T&gt;<br />static member CancellationToken : Async&lt;CancellationToken&gt;<br />static member DefaultCancellationToken : CancellationToken<br /><br />Full name: Microsoft.FSharp.Control.Async<br /><br />--------------------<br />type Async&lt;&#39;T&gt;<br /><br />Full name: Microsoft.FSharp.Control.Async&lt;_&gt;</div>
<div class="tip" id="fs47">type unit = Unit<br /><br />Full name: Microsoft.FSharp.Core.unit</div>
<div class="tip" id="fs48">type Globals<br /><br />Full name: FunScript.TypeScript.Globals</div>
<div class="tip" id="fs49">property Globals.window: Window</div>
<div class="tip" id="fs50">property Window.document: Document</div>
<div class="tip" id="fs51">property Document.title: string</div>
<div class="tip" id="fs52">Multiple items<br />val string : value:&#39;T -&gt; string<br /><br />Full name: Microsoft.FSharp.Core.Operators.string<br /><br />--------------------<br />type string = System.String<br /><br />Full name: Microsoft.FSharp.Core.string</div>
<div class="tip" id="fs53">static member Async.Sleep : millisecondsDueTime:int -&gt; Async&lt;unit&gt;</div>
<div class="tip" id="fs54">Multiple items<br />module List<br /><br />from Microsoft.FSharp.Collections<br /><br />--------------------<br />type List&lt;&#39;T&gt; =<br />&#160;&#160;| ( [] )<br />&#160;&#160;| ( :: ) of Head: &#39;T * Tail: &#39;T list<br />&#160;&#160;interface IEnumerable<br />&#160;&#160;interface IEnumerable&lt;&#39;T&gt;<br />&#160;&#160;member Head : &#39;T<br />&#160;&#160;member IsEmpty : bool<br />&#160;&#160;member Item : index:int -&gt; &#39;T with get<br />&#160;&#160;member Length : int<br />&#160;&#160;member Tail : &#39;T list<br />&#160;&#160;static member Cons : head:&#39;T * tail:&#39;T list -&gt; &#39;T list<br />&#160;&#160;static member Empty : &#39;T list<br /><br />Full name: Microsoft.FSharp.Collections.List&lt;_&gt;</div>
<div class="tip" id="fs55">val filter : predicate:(&#39;T -&gt; bool) -&gt; list:&#39;T list -&gt; &#39;T list<br /><br />Full name: Microsoft.FSharp.Collections.List.filter</div>
<div class="tip" id="fs56">val map : mapping:(&#39;T -&gt; &#39;U) -&gt; list:&#39;T list -&gt; &#39;U list<br /><br />Full name: Microsoft.FSharp.Collections.List.map</div>
<div class="tip" id="fs57">val readAndProcess : readInput:(unit -&gt; string) -&gt; processInput:(string -&gt; &#39;a) -&gt; &#39;a option<br /><br />Full name: Library-frameworks_.readAndProcess</div>
<div class="tip" id="fs58">type File =<br />&#160;&#160;interface<br />&#160;&#160;&#160;&#160;inherit Blob<br />&#160;&#160;end<br /><br />Full name: FunScript.TypeScript.File</div>
<div class="tip" id="fs59">File.ReadAllText(path: string) : string<br />File.ReadAllText(path: string, encoding: System.Text.Encoding) : string</div>
<div class="tip" id="fs60">val s : string</div>
<div class="tip" id="fs61">System.String.ToUpper() : string<br />System.String.ToUpper(culture: System.Globalization.CultureInfo) : string</div>
<div class="tip" id="fs62">val readInput : (unit -&gt; string)</div>
<div class="tip" id="fs63">val processInput : (string -&gt; &#39;a)</div>
<div class="tip" id="fs64">val input : string</div>
<div class="tip" id="fs65">namespace System</div>
<div class="tip" id="fs66">namespace System.IO</div>
<div class="tip" id="fs67">Multiple items<br />type IOException =<br />&#160;&#160;inherit SystemException<br />&#160;&#160;new : unit -&gt; IOException + 3 overloads<br /><br />Full name: System.IO.IOException<br /><br />--------------------<br />IOException() : unit<br />IOException(message: string) : unit<br />IOException(message: string, hresult: int) : unit<br />IOException(message: string, innerException: exn) : unit</div>
<div class="tip" id="fs68">val ignoreIOErrors : f:(unit -&gt; &#39;a) -&gt; &#39;a option<br /><br />Full name: Library-frameworks_.ignoreIOErrors</div>
<div class="tip" id="fs69">val f : (unit -&gt; &#39;a)</div>
<div class="tip" id="fs70">val validateInput : input:string -&gt; string option<br /><br />Full name: Library-frameworks_.validateInput</div>
<div class="tip" id="fs71">val map : mapping:(&#39;T -&gt; &#39;U) -&gt; option:&#39;T option -&gt; &#39;U option<br /><br />Full name: Microsoft.FSharp.Core.Option.map</div>
<div class="tip" id="fs72">val valid : string</div>
<div class="tip" id="fs73">type Game<br /><br />Full name: libraryframeworks.Game</div>
<div class="tip" id="fs74">type IEvent&lt;&#39;T&gt; = IEvent&lt;Handler&lt;&#39;T&gt;,&#39;T&gt;<br /><br />Full name: Microsoft.FSharp.Control.IEvent&lt;_&gt;</div>
<div class="tip" id="fs75">type bool = System.Boolean<br /><br />Full name: Microsoft.FSharp.Core.bool</div>
<div class="tip" id="fs76">val game : Inverted.Game<br /><br />Full name: Library-frameworks_.game</div>
<div class="tip" id="fs77">module Inverted<br /><br />from Library-frameworks_</div>
<div class="tip" id="fs78">Multiple items<br />type Game =<br />&#160;&#160;new : unit -&gt; Game<br />&#160;&#160;member Draw : IEvent&lt;DrawingContext&gt;<br />&#160;&#160;member IsRunning : bool<br />&#160;&#160;member Update : IEvent&lt;unit&gt;<br /><br />Full name: Library-frameworks_.Inverted.Game<br /><br />--------------------<br />new : unit -&gt; Inverted.Game</div>
<div class="tip" id="fs79">val mario : Image<br /><br />Full name: Library-frameworks_.mario</div>
<div class="tip" id="fs80">val loop : x:int -&gt; Async&lt;unit&gt;<br /><br />Full name: Library-frameworks_.loop</div>
<div class="tip" id="fs81">val x : int</div>
<div class="tip" id="fs82">property Inverted.Game.IsRunning: bool</div>
<div class="tip" id="fs83">val evt : Choice&lt;unit,DrawingContext&gt;</div>
<div class="tip" id="fs84">static member Async.AwaitObservable : ev1:System.IObservable&lt;&#39;T1&gt; -&gt; Async&lt;&#39;T1&gt;<br /><em><br /><br />&#160;Creates an asynchronous workflow that will be resumed when the <br />&#160;specified observables produces a value. The workflow will return <br />&#160;the value produced by the observable.</em><br />static member Async.AwaitObservable : ev1:System.IObservable&lt;&#39;T1&gt; * ev2:System.IObservable&lt;&#39;T2&gt; -&gt; Async&lt;Choice&lt;&#39;T1,&#39;T2&gt;&gt;<br /><em><br /><br />&#160;Creates an asynchronous workflow that will be resumed when the <br />&#160;first of the specified two observables produces a value. The <br />&#160;workflow will return a Choice value that can be used to identify<br />&#160;the observable that produced the value.</em><br />static member Async.AwaitObservable : ev1:System.IObservable&lt;&#39;T1&gt; * ev2:System.IObservable&lt;&#39;T2&gt; * ev3:System.IObservable&lt;&#39;T3&gt; -&gt; Async&lt;Choice&lt;&#39;T1,&#39;T2,&#39;T3&gt;&gt;<br /><em><br /><br />&#160;Creates an asynchronous workflow that will be resumed when the <br />&#160;first of the specified three observables produces a value. The <br />&#160;workflow will return a Choice value that can be used to identify<br />&#160;the observable that produced the value.</em><br />static member Async.AwaitObservable : ev1:System.IObservable&lt;&#39;T1&gt; * ev2:System.IObservable&lt;&#39;T2&gt; * ev3:System.IObservable&lt;&#39;T3&gt; * ev4:System.IObservable&lt;&#39;T4&gt; -&gt; Async&lt;Choice&lt;&#39;T1,&#39;T2,&#39;T3,&#39;T4&gt;&gt;<br /><em><br /><br />&#160;Creates an asynchronous workflow that will be resumed when the <br />&#160;first of the specified four observables produces a value. The <br />&#160;workflow will return a Choice value that can be used to identify<br />&#160;the observable that produced the value.</em></div>
<div class="tip" id="fs85">property Inverted.Game.Update: IEvent&lt;unit&gt;</div>
<div class="tip" id="fs86">property Inverted.Game.Draw: IEvent&lt;DrawingContext&gt;</div>
<div class="tip" id="fs87">union case Choice.Choice1Of2: &#39;T1 -&gt; Choice&lt;&#39;T1,&#39;T2&gt;</div>
<div class="tip" id="fs88">union case Choice.Choice2Of2: &#39;T2 -&gt; Choice&lt;&#39;T1,&#39;T2&gt;</div>
<div class="tip" id="fs89">val startGame : draw:(&#39;a -&gt; DrawingContext -&gt; unit) -&gt; update:(&#39;a -&gt; &#39;a) -&gt; init:&#39;a -&gt; Async&lt;unit&gt;<br /><br />Full name: Library-frameworks_.startGame</div>
<div class="tip" id="fs90">val draw : (&#39;a -&gt; DrawingContext -&gt; unit)</div>
<div class="tip" id="fs91">val update : (&#39;a -&gt; &#39;a)</div>
<div class="tip" id="fs92">val init : &#39;a</div>
<div class="tip" id="fs93">val game : Inverted.Game</div>
<div class="tip" id="fs94">val loop : (&#39;a -&gt; Async&lt;unit&gt;)</div>
<div class="tip" id="fs95">val x : &#39;a</div>
<div class="tip" id="fs96">val toFrame : matrix:&#39;a -&gt; &#39;b<br /><br />Full name: Library-frameworks_.Matrix.toFrame</div>
<div class="tip" id="fs97">val matrix : &#39;a</div>
<div class="tip" id="fs98">module Frame<br /><br />from Library-frameworks_</div>
<div class="tip" id="fs99">val toMatrix : frame:&#39;a -&gt; &#39;b<br /><br />Full name: Library-frameworks_.Frame.toMatrix</div>
<div class="tip" id="fs100">val frame : &#39;a</div>


<div class="row">
  <div class="small-6 columns"><p class="post-discuss">
		Discuss <a href="http://twitter.com/tomaspetricek">on twitter</a>, <script type="text/javascript" src="http://www.reddit.com/buttonlite.js?i=0"></script>.<br />
		Send corrections via <a href="https://github.com/tpetricek/TomaspNet.Website">GitHub pull requests</a>.
	</p></div>
  <div class="small-6 columns">

<!-- AddThis Button BEGIN -->
<div class="addthis_toolbox addthis_default_style addthis_16x16_style">
<a class="addthis_button_twitter"></a>
<a class="addthis_button_reddit"></a>
<a class="addthis_button_google_plusone_share"></a>
<a class="addthis_button_hackernews"></a>
<a class="addthis_button_facebook"></a>
<a class="addthis_button_compact"></a><a class="addthis_counter addthis_bubble_style"></a>
</div>
<script type="text/javascript">var addthis_config = { "data_track_addressbar": false };</script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-521c32162e6001a0"></script>
<!-- AddThis Button END -->

<p class="post-meta">
  <span><strong>Published</strong> Sunday, 1 March 2015, 4:54 PM</span><br />      
  <span><strong>By</strong> <a href="https://plus.google.com/+TomasPetriceks?rel=author">Tomas Petricek</a></span><br />
  <span class="tags"><strong>Tags</strong> f#, open source, functional programming</span>
</p>

  </div>
</div>

    </content>

  </div>
  <div class="large-4 columns" id="right-bar">
    <div class="right-item" id="right-calendar">
<script type="text/javascript">
  var monthNames =
    ["January", "February", "March", "April", "May", "June",
      "July", "August", "September", "October", "November", "December"];
  var d = new Date();
  var m = monthNames[d.getMonth()];
  var y = d.getFullYear();
  var ml = m.toLowerCase();
  document.writeln("<h4>Calendar - " + m + " " + y + "</h4>");
  document.writeln("<a href=\"http://tomasp.net/calendar/" + y + "/" + ml + ".html\">" +
    "<img src=\"http://tomasp.net/calendar/" + y + "/" + ml + "-preview.jpg\" style=\"border-style:none;\" />" +
    "</a>");
</script> 
<p>The calendar shows a new picture each month. See photos for
  <a href="http://tomasp.net/calendar/2005">2005</a>, <a href="http://tomasp.net/calendar/2006">2006</a>, 
  <a href="http://tomasp.net/calendar/2007">2007</a>, <a href="http://tomasp.net/calendar/2008">2008</a>, 
  <a href="http://tomasp.net/calendar/2009">2009</a>, <a href="http://tomasp.net/calendar/2010">2010</a>, 
  <a href="http://tomasp.net/calendar/2011">2011</a>, <a href="http://tomasp.net/calendar/2012">2012</a>,
  <a href="http://tomasp.net/calendar/2013">2013</a>, <a href="http://tomasp.net/calendar/2014">2014</a>
  and the first photos of <a href="http://tomasp.net/calendar/2015">2015</a>.
</p>
</div>

    <h3>Welcome!</h3>
    <img src="http://tomasp.net/img/tomas.jpg" alt="Tomas Petricek" style="float:right;margin:10px 0px 10px 10px;" />
    <p>I'm an F# open-source developer, book author and computer scientist. I submitted my PhD thesis recently.
      When offline, I enjoy traveling and taking pictures. You can find me at
      at <a href="http://twitter.com/tomaspetricek">@tomaspetricek</a> or email 
      <a href="mailto:tomas@tomasp.net">tomas@tomasp.net</a>.
    </p>

    <h4>Trainings and consulting</h4>
    <a href="http://fsharpworks.com"><img src="http://tomasp.net/img/fsharpworks.png" alt="F# Works" style="float:right;margin:15px 0px 10px 10px; width:150px" /></a>
    <p>I'm an experienced F# developer and trainer. <br /> I offer training and consulting
      services through <a href="http://fsharpworks.com">F# Works</a>.
    </p>
    <ul>
      <li>Check out my <a href="http://fsharpworks.com/workshops/fast-track.html">in-person Fast Track to F#</a> course</li>
      <li>Check out my <a href="http://fsharpworks.com/workshops/finance.html">online F# in Finance</a> course</li>
      <li><a href="mailto:tomas@tomasp.net">Email me</a> for info about private trainings</li>
    </ul>
    
    <script type="text/javascript" src="http://tomasp.net/news/news.js"></script>
    <h4>What's new? &#160; <small><script type="text/javascript">document.write(news.date)</script></small></h4>
    <script>
      document.write(news.info);
    </script>

    <h4>Functional F# and C# books</h4>
    <div style="float:right;">
      <a href="http://www.amazon.com/gp/product/1933988924/ref=as_li_tf_il?ie=UTF8&amp;tag=httptomasnet-20&amp;linkCode=as2&amp;camp=217145&amp;creative=399369&amp;creativeASIN=1933988924">
        <img src="http://tomasp.net/img/deepdives.png" alt="F# Deep Dives" style="float:right;margin:15px 0px 15px 10px;border-style:none;" />
      </a>
    </div>
    <p>
      I wrote or contributed to two books on F# and functional programming:
      <a href="http://functional-programming.net/rwfp">Real World Functional Programming</a> explains functional
      concepts using F# and C# and <a href="http://functional-programming.net/deepdives">F# Deep Dives</a> is a 
      collection of case studies written by industry experts.</p>
    <ul>
      <li><a href="http://functional-programming.net/rwfp"><strong>Real World Funcitonal Programming</strong></a> home page. See
        <a href="http://manning.com/petricek">Manning</a>,
        <a href="https://www.amazon.com/dp/1933988924?tag=httptomasnet-20&amp;camp=213381&amp;creative=390973&amp;linkCode=as4&amp;creativeASIN=1933988924&amp;adid=0F1DP260JGG4KY0CDGP6">Amazon.com</a> or
        <a href="https://www.amazon.co.uk/dp/1933988924?tag=tomasnet-21&amp;camp=1406&amp;creative=6394&amp;linkCode=as1&amp;creativeASIN=1933988924&amp;adid=1CTY87YCCQEJW965GNDF">Amazon.co.uk</a>.
      </li>
      <li><a href="http://functional-programming.net/deepdives"><strong>F# Deep Dives</strong></a> home page. Get it from
        <a href="http://www.manning.com/petricek2">Manning.com</a>,
        <a href="http://www.amazon.com/gp/product/1617291323/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1617291323&linkCode=as2&tag=httptomasnet-20&linkId=U4FPJJSKKCCKGNHD">Amazon.com</a> or
        <a href="http://www.amazon.co.uk/gp/product/1617291323/ref=as_li_tl?ie=UTF8&camp=1634&creative=19450&creativeASIN=1617291323&linkCode=as2&tag=tomasnet-21&linkId=HTUYVHHGWB4Q7X6V">Amazon.co.uk</a>.
      </li>
    </ul>    
    <p>I also wrote a series of tutorials on <a href="http://www.tryfsharp.org/Learn/financial-computing">financial computing for Try F#</a>.
      This interactive environment let's you try F# in the browser.</p>

    <h4>Research and teaching</h4>
    <img src="http://tomasp.net/img/cam.png" alt="University of Cambride" style="float:right;margin:25px 0px 10px 10px;" />
    <p>I submitted my PhD thesis at the <a href="http://www.cl.cam.ac.uk/">University of Cambridge</a>,
      working on making better types for programs that run in rich context (like F# type providers, distributed 
      prog&shy;ramming or data-flow). See <a href="http://tomasp.net/academic/">my academic page</a> for
      more.</p>

    <h4>Blog tags</h4>
    <p>

      <a href="http://tomasp.net/blog/tag/fsharp/">f#</a>&nbsp;(100),       <a href="http://tomasp.net/blog/tag/csharp/">c#</a>&nbsp;(33),       <a href="http://tomasp.net/blog/tag/functional-programming/">functional programming</a>&nbsp;(12),       <a href="http://tomasp.net/blog/tag/research/">research</a>&nbsp;(29),       <a href="http://tomasp.net/blog/tag/open-source/">open source</a>&nbsp;(5),       <a href="http://tomasp.net/blog/tag/fun/">fun</a>&nbsp;(3),       <a href="http://tomasp.net/blog/tag/talks/">talks</a>&nbsp;(4),       <a href="http://tomasp.net/blog/tag/data-science/">data science</a>&nbsp;(2),       <a href="http://tomasp.net/blog/tag/monads/">monads</a>&nbsp;(2),       <a href="http://tomasp.net/blog/tag/fslab/">fslab</a>&nbsp;(1),       <a href="http://tomasp.net/blog/tag/deedle/">deedle</a>&nbsp;(1),       <a href="http://tomasp.net/blog/tag/philosophy/">philosophy</a>&nbsp;(1)    </p>

  </div>
</div>


  <div class="row" id="footer">
  <footer>   
    <div class="large-3 columns">
      <h4>Contact &amp; about</h4>
      <p>This site is hosted on GitHub and is generated using <a href="https://github.com/tpetricek/FSharp.Formatting">F# Formatting</a>.
        For more info, see the <a href="https://github.com/tpetricek/TomaspNet.Website">website source on GitHub</a>.
      </p>
      <p>Please submit issues &amp; corrections on GitHub. Use pull requests for minor corrections only.</p>
      <ul>
        <li>Email me: <a href="mailto:tomas@tomasp.net">tomas@tomasp.net</a></li>
        <li>Connect via Twitter: <a href="http://twitter.com/tomaspetricek">@tomaspetricek</a></li>
        <li>More: <a href="http://uk.linkedin.com/in/tomaspetricek">LinkedIn</a> | <a href="http://lanyrd.com/profile/tomasp/">Lanyrd</a> | <a href="https://github.com/tpetricek">GitHub</a></li>
      </ul>
    </div>
    <div class="large-7 columns">
    <h4>Blog archives <a href="http://tomasp.net/rss.xml"><img src="http://tomasp.net/img/rss.gif" /></a></h4>
      <a href="http://tomasp.net/blog/archive/march-2015/index.html">
        March 2015 (1)</a>,      <a href="http://tomasp.net/blog/archive/february-2015/index.html">
        February 2015 (1)</a>,      <a href="http://tomasp.net/blog/archive/january-2015/index.html">
        January 2015 (2)</a>,      <a href="http://tomasp.net/blog/archive/december-2014/index.html">
        December 2014 (1)</a>,      <a href="http://tomasp.net/blog/archive/may-2014/index.html">
        May 2014 (3)</a>,      <a href="http://tomasp.net/blog/archive/april-2014/index.html">
        April 2014 (2)</a>,      <a href="http://tomasp.net/blog/archive/march-2014/index.html">
        March 2014 (1)</a>,      <a href="http://tomasp.net/blog/archive/january-2014/index.html">
        January 2014 (2)</a>,      <a href="http://tomasp.net/blog/archive/december-2013/index.html">
        December 2013 (1)</a>,      <a href="http://tomasp.net/blog/archive/november-2013/index.html">
        November 2013 (1)</a>,      <a href="http://tomasp.net/blog/archive/october-2013/index.html">
        October 2013 (1)</a>,      <a href="http://tomasp.net/blog/archive/september-2013/index.html">
        September 2013 (1)</a>,      <a href="http://tomasp.net/blog/archive/august-2013/index.html">
        August 2013 (2)</a>,      <a href="http://tomasp.net/blog/archive/may-2013/index.html">
        May 2013 (1)</a>,      <a href="http://tomasp.net/blog/archive/april-2013/index.html">
        April 2013 (1)</a>,      <a href="http://tomasp.net/blog/archive/march-2013/index.html">
        March 2013 (1)</a>,      <a href="http://tomasp.net/blog/archive/february-2013/index.html">
        February 2013 (1)</a>,      <a href="http://tomasp.net/blog/archive/january-2013/index.html">
        January 2013 (1)</a>,      <a href="http://tomasp.net/blog/archive/december-2012/index.html">
        December 2012 (2)</a>,      <a href="http://tomasp.net/blog/archive/october-2012/index.html">
        October 2012 (1)</a>,      <a href="http://tomasp.net/blog/archive/august-2012/index.html">
        August 2012 (3)</a>,      <a href="http://tomasp.net/blog/archive/june-2012/index.html">
        June 2012 (2)</a>,      <a href="http://tomasp.net/blog/archive/april-2012/index.html">
        April 2012 (1)</a>,      <a href="http://tomasp.net/blog/archive/march-2012/index.html">
        March 2012 (4)</a>,      <a href="http://tomasp.net/blog/archive/february-2012/index.html">
        February 2012 (5)</a>,      <a href="http://tomasp.net/blog/archive/january-2012/index.html">
        January 2012 (2)</a>,      <a href="http://tomasp.net/blog/archive/november-2011/index.html">
        November 2011 (5)</a>,      <a href="http://tomasp.net/blog/archive/august-2011/index.html">
        August 2011 (3)</a>,      <a href="http://tomasp.net/blog/archive/july-2011/index.html">
        July 2011 (2)</a>,      <a href="http://tomasp.net/blog/archive/june-2011/index.html">
        June 2011 (2)</a>,      <a href="http://tomasp.net/blog/archive/may-2011/index.html">
        May 2011 (2)</a>,      <a href="http://tomasp.net/blog/archive/march-2011/index.html">
        March 2011 (4)</a>,      <a href="http://tomasp.net/blog/archive/december-2010/index.html">
        December 2010 (1)</a>,      <a href="http://tomasp.net/blog/archive/november-2010/index.html">
        November 2010 (6)</a>,      <a href="http://tomasp.net/blog/archive/october-2010/index.html">
        October 2010 (6)</a>,      <a href="http://tomasp.net/blog/archive/september-2010/index.html">
        September 2010 (4)</a>,      <a href="http://tomasp.net/blog/archive/july-2010/index.html">
        July 2010 (3)</a>,      <a href="http://tomasp.net/blog/archive/june-2010/index.html">
        June 2010 (2)</a>,      <a href="http://tomasp.net/blog/archive/may-2010/index.html">
        May 2010 (1)</a>,      <a href="http://tomasp.net/blog/archive/february-2010/index.html">
        February 2010 (2)</a>,      <a href="http://tomasp.net/blog/archive/january-2010/index.html">
        January 2010 (3)</a>,      <a href="http://tomasp.net/blog/archive/december-2009/index.html">
        December 2009 (3)</a>,      <a href="http://tomasp.net/blog/archive/july-2009/index.html">
        July 2009 (1)</a>,      <a href="http://tomasp.net/blog/archive/june-2009/index.html">
        June 2009 (3)</a>,      <a href="http://tomasp.net/blog/archive/may-2009/index.html">
        May 2009 (2)</a>,      <a href="http://tomasp.net/blog/archive/april-2009/index.html">
        April 2009 (1)</a>,      <a href="http://tomasp.net/blog/archive/march-2009/index.html">
        March 2009 (2)</a>,      <a href="http://tomasp.net/blog/archive/february-2009/index.html">
        February 2009 (1)</a>,      <a href="http://tomasp.net/blog/archive/december-2008/index.html">
        December 2008 (1)</a>,      <a href="http://tomasp.net/blog/archive/november-2008/index.html">
        November 2008 (5)</a>,      <a href="http://tomasp.net/blog/archive/october-2008/index.html">
        October 2008 (1)</a>,      <a href="http://tomasp.net/blog/archive/september-2008/index.html">
        September 2008 (1)</a>,      <a href="http://tomasp.net/blog/archive/june-2008/index.html">
        June 2008 (1)</a>,      <a href="http://tomasp.net/blog/archive/march-2008/index.html">
        March 2008 (3)</a>,      <a href="http://tomasp.net/blog/archive/february-2008/index.html">
        February 2008 (1)</a>,      <a href="http://tomasp.net/blog/archive/december-2007/index.html">
        December 2007 (2)</a>,      <a href="http://tomasp.net/blog/archive/november-2007/index.html">
        November 2007 (6)</a>,      <a href="http://tomasp.net/blog/archive/october-2007/index.html">
        October 2007 (1)</a>,      <a href="http://tomasp.net/blog/archive/september-2007/index.html">
        September 2007 (1)</a>,      <a href="http://tomasp.net/blog/archive/august-2007/index.html">
        August 2007 (1)</a>,      <a href="http://tomasp.net/blog/archive/july-2007/index.html">
        July 2007 (2)</a>,      <a href="http://tomasp.net/blog/archive/april-2007/index.html">
        April 2007 (2)</a>,      <a href="http://tomasp.net/blog/archive/march-2007/index.html">
        March 2007 (3)</a>,      <a href="http://tomasp.net/blog/archive/february-2007/index.html">
        February 2007 (3)</a>,      <a href="http://tomasp.net/blog/archive/january-2007/index.html">
        January 2007 (2)</a>,      <a href="http://tomasp.net/blog/archive/november-2006/index.html">
        November 2006 (1)</a>,      <a href="http://tomasp.net/blog/archive/october-2006/index.html">
        October 2006 (3)</a>,      <a href="http://tomasp.net/blog/archive/august-2006/index.html">
        August 2006 (2)</a>,      <a href="http://tomasp.net/blog/archive/july-2006/index.html">
        July 2006 (1)</a>,      <a href="http://tomasp.net/blog/archive/june-2006/index.html">
        June 2006 (3)</a>,      <a href="http://tomasp.net/blog/archive/may-2006/index.html">
        May 2006 (2)</a>,      <a href="http://tomasp.net/blog/archive/april-2006/index.html">
        April 2006 (2)</a>,      <a href="http://tomasp.net/blog/archive/december-2005/index.html">
        December 2005 (1)</a>,      <a href="http://tomasp.net/blog/archive/july-2005/index.html">
        July 2005 (4)</a>,      <a href="http://tomasp.net/blog/archive/june-2005/index.html">
        June 2005 (5)</a>,      <a href="http://tomasp.net/blog/archive/may-2005/index.html">
        May 2005 (1)</a>,      <a href="http://tomasp.net/blog/archive/april-2005/index.html">
        April 2005 (3)</a>,      <a href="http://tomasp.net/blog/archive/march-2005/index.html">
        March 2005 (3)</a>,      <a href="http://tomasp.net/blog/archive/january-2005/index.html">
        January 2005 (1)</a>,      <a href="http://tomasp.net/blog/archive/december-2004/index.html">
        December 2004 (3)</a>,      <a href="http://tomasp.net/blog/archive/november-2004/index.html">
        November 2004 (2)</a>,    </div>
    <div class="large-2 columns">
      <h4>License</h4>
      <p>Unless explicitly mentioned, all articles on this site are licensed under <a href="http://creativecommons.org/licenses/by-sa/3.0/">Creative Commons Attribution Share Alike</a>. 
        All source code samples are licensed under Apache 2.0.
      </p>
      <img src="http://tomasp.net/img/cc-sa.png" alt="CC License logo" />
    </div>
  </footer>
  </div>
  
  <script>
  document.write('<script src=' +
  ('__proto__' in {} ? 'http://tomasp.net/js/vendor/zepto' : 'http://tomasp.net/js/vendor/jquery') +
  '.js><\/script>')
  </script>
  
  <script src="http://tomasp.net/js/foundation.min.js"></script>
  <script>
    $(document).foundation();
  </script>
  <script type="text/javascript">

    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-1561220-1']);
    _gaq.push(['_trackPageview']);

    (function () {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();

  </script>
  <script src="http://cdn.lanyrd.net/badges/person-v1.min.js"></script>
</body>
</html>